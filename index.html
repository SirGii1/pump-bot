<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pro Pump Monitor</title>
    <style>
        /* Modern Dark Trading Terminal Style */
        body { font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background-color: #0d1117; color: #e6edf3; margin: 0; padding: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        .header { width: 100%; background: #161b22; padding: 20px; text-align: center; border-bottom: 1px solid #30363d; box-shadow: 0 4px 12px rgba(0,0,0,0.5); position: sticky; top: 0; z-index: 100; }
        .header h2 { margin: 0; color: #58a6ff; font-size: 24px; letter-spacing: 1px; }
        .status-badge { display: inline-block; margin-top: 10px; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; background: #238636; color: white; border: 1px solid rgba(255,255,255,0.2); }
        
        .feed-container { width: 90%; max-width: 600px; margin-top: 20px; padding-bottom: 50px; }
        
        /* Token Card Styling */
        .token-card { background: #161b22; border: 1px solid #30363d; border-radius: 12px; padding: 20px; margin-bottom: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); transition: transform 0.2s; }
        .token-card:hover { transform: translateY(-2px); border-color: #58a6ff; }
        
        .token-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .token-title { font-size: 18px; font-weight: bold; color: #fff; }
        .token-symbol { color: #8b949e; font-size: 14px; margin-left: 5px; }
        
        .ca-container { background: #0d1117; padding: 10px; border-radius: 6px; border: 1px dashed #30363d; font-family: 'Courier New', monospace; font-size: 13px; color: #a5d6ff; word-break: break-all; margin: 10px 0; user-select: all; cursor: pointer; }
        
        .action-buttons { display: flex; gap: 10px; margin-top: 15px; flex-wrap: wrap; }
        .btn { flex: 1; text-align: center; padding: 10px; border-radius: 6px; text-decoration: none; font-size: 14px; font-weight: 600; min-width: 80px; }
        .btn-pump { background: #1db954; color: black; } /* Green for Buy */
        .btn-tg { background: #2481cc; color: white; }
        .btn-x { background: #000; color: white; border: 1px solid #333; }
        .btn-web { background: #30363d; color: white; }
    </style>
</head>
<body>

<div class="header">
    <h2>üöÄ Pump.fun Monitor</h2>
    <div id="status" class="status-badge">Initializing...</div>
</div>

<div class="feed-container" id="feed">
    </div>

<script>
    const BOT_TOKEN = "8579945497:AAG2rxeNscB9mo--d2F1l3dWvwqiUlFuEz8";
    const CHAT_ID = "-1003566409395";

    const ws = new WebSocket('wss://pumpportal.fun/api/data');
    const statusDiv = document.getElementById('status');
    const feed = document.getElementById('feed');

    ws.onopen = () => {
        statusDiv.innerText = "üü¢ System Online & Tracking";
        ws.send(JSON.stringify({ method: "subscribeNewToken" }));
    };

    ws.onmessage = async (event) => {
        const data = JSON.parse(event.data);
        if (data.txType === "create") {
            processToken(data);
        }
    };

    async function processToken(token) {
        const mint = token.mint;
        const name = token.name || "Unknown";
        const symbol = token.symbol || "TOKEN";
        
        // 1. Fetch Metadata (Socials)
        let twitter = token.twitter || "";
        let telegram = token.telegram || "";
        let website = token.website || "";

        if (!twitter && !telegram && token.uri) {
            try {
                const metaReq = await fetch(token.uri);
                const meta = await metaReq.json();
                twitter = meta.twitter || twitter;
                telegram = meta.telegram || telegram;
                website = meta.website || website;
            } catch (e) { console.log("Meta fetch error"); }
        }

        const pumpLink = `https://pump.fun/${mint}`;
        const solscanLink = `https://solscan.io/token/${mint}`;

        // 2. Add to Website Dashboard (ALL TOKENS shown here)
        const card = document.createElement('div');
        card.className = 'token-card';
        card.innerHTML = `
            <div class="token-header">
                <div><span class="token-title">${name}</span> <span class="token-symbol">($${symbol})</span></div>
            </div>
            <div class="ca-container" onclick="navigator.clipboard.writeText('${mint}')" title="Click to Copy">${mint}</div>
            <div class="action-buttons">
                <a href="${pumpLink}" target="_blank" class="btn btn-pump">üíä Buy</a>
                ${telegram ? `<a href="${telegram}" target="_blank" class="btn btn-tg">Telegram</a>` : ''}
                ${twitter ? `<a href="${twitter}" target="_blank" class="btn btn-x">X (Twitter)</a>` : ''}
                ${website ? `<a href="${website}" target="_blank" class="btn btn-web">Website</a>` : ''}
            </div>
        `;
        feed.prepend(card);

        // 3. TELEGRAM FILTER: Only send if Telegram link exists!
        if (telegram) {
            
            // Build Socials List
            let linksList = [];
            linksList.push(`‚úàÔ∏è <a href="${telegram}">Telegram</a>`); // We know TG exists here
            if (twitter) linksList.push(`üê¶ <a href="${twitter}">Twitter</a>`);
            if (website) linksList.push(`üåê <a href="${website}">Website</a>`);
            
            const socialSection = `\n\n<b>Socials:</b>\n${linksList.join('  |  ')}`;

            const message = `üü¢ <b>NEW PUMP.FUN TOKEN FOUND</b>\n` +
                            `---------------------------------\n` +
                            `üíé <b>${name}</b> ($${symbol})\n` +
                            `---------------------------------\n` +
                            `üìã <b>CA:</b> (Tap to copy)\n` +
                            `<code>${mint}</code>` + 
                            `${socialSection}\n\n` +
                            `üíä <a href="${pumpLink}"><b>Buy on Pump.fun</b></a>\n` +
                            `üîç <a href="${solscanLink}">Scan on Solscan</a>`;

            fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    chat_id: CHAT_ID,
                    text: message,
                    parse_mode: 'HTML',
                    disable_web_page_preview: true
                })
            });
        }
    }
</script>

</body>
</html>
